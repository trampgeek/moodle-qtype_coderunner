define ("qtype_coderunner/ui_html",["jquery"],function(a){function b(b,c,d,e){this.textArea=a(document.getElementById(b));this.textareaId=b;var f=e.html_src||"globalextra";this.html=this.textArea.attr("data-"+f);this.html=this.html.replace(/___textareaId___/gm,b);this.readOnly=this.textArea.prop("readonly");this.uiParams=e;this.fail=!1;this.htmlDiv=null;this.reload()}b.prototype.failed=function(){return this.fail};b.prototype.failMessage=function(){return"htmluiloadfail"};b.prototype.sync=function(){var b={},c,d=!0;this.getFields().each(function(){var e,f;f=a(this).attr("type");c=a(this).attr("name");if(("checkbox"===f||"radio"===f)&&!a(this).is(":checked")){e=""}else{e=a(this).val()}if(b.hasOwnProperty(c)){b[c].push(e)}else{b[c]=[e]}if(""!==e){d=!1}});if(d){this.textArea.val("")}else{this.textArea.val(JSON.stringify(b))}};b.prototype.getElement=function(){return this.htmlDiv};b.prototype.getFields=function(){return a(this.htmlDiv).find(".coderunner-ui-element")};b.prototype.setField=function(a,b){if("checkbox"===a.attr("type")||"radio"===a.attr("type")){a.prop("checked",a.val()===b)}else{a.val(b)}};b.prototype.reload=function(){var b=a(this.textArea).val(),c,d,e,f,g,h="qtype-coderunner-outer-div-"+this.textareaId.toString();this.htmlDiv=a("<div style='height:fit-content' class='qtype-coderunner-html-outer-div' id='"+h+"'>"+this.html+"</div>");this.htmlDiv.data("uiparams",this.uiParams);this.htmlDiv.data("templateparams",this.uiParams);if(b){try{c=JSON.parse(b);g={};for(var j in c){d=c[j];f=this.getFields().filter("[name='"+j+"']");g[j]=[];for(e=0;e<d.length;e++){if(e<f.length){this.setField(a(f[e]),d[e])}else{g[j].push(d[e])}}if(0===g[j].length){delete g[j]}}if(!a.isEmptyObject(g)){this.htmlDiv.data("leftovers",g)}}catch(a){this.fail=!0}}};b.prototype.resize=function(){};b.prototype.hasFocus=function(){var a=!1;this.getFields().each(function(){if(this===document.activeElement){a=!0}});return a};b.prototype.destroy=function(){this.sync();a(this.htmlDiv).remove();this.htmlDiv=null};return{Constructor:b}});
//# sourceMappingURL=ui_html.min.js.map
